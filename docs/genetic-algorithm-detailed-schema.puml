@startuml Генетический алгоритм - детальная схема

!theme plain
skinparam backgroundColor #FFFFFF
skinparam defaultFontSize 11
skinparam roundcorner 8

title Детальная схема работы генетического алгоритма

package "1. Инициализация" {
    rectangle "Начальная популяция" as init {
        :30 особей (стратегий);
        :Случайные параметры;
        :SMA(100-200);
        :EMA(100-200);
        :StopLoss(1.0-5.0);
    }
}

package "2. Оценка (Fitness)" {
    rectangle "Тестирование" as eval {
        :Backtest стратегии;
        :Расчет метрик:
        :• Total Profit
        :• Sharpe Ratio
        :• Drawdown
        :• Win Rate
        :• Profit Factor;
        :Fitness = взвешенная сумма;
    }
}

package "3. Эволюционный цикл" {
    
    rectangle "Селекция" as selection {
        :Сортировка по fitness;
        :Рулетка (roulette wheel);
        :Вероятность ∝ fitness;
        :Выбор 2 родителей;
    }
    
    rectangle "Скрещивание" as crossover {
        :Родитель 1: SMA(100), EMA(120);
        :Родитель 2: SMA(150), EMA(100);
        :---;
        :Потомок 1: SMA(100), EMA(100);
        :Потомок 2: SMA(150), EMA(120);
    }
    
    rectangle "Мутация" as mutation {
        :Случайный параметр;
        :Изменение в диапазоне;
        :SMA(100) → SMA(105);
        :Вероятность: 10%;
    }
    
    rectangle "Элитизм" as elitism {
        :Топ-3 стратегии;
        :Автоматически в\nследующее поколение;
        :Гарантия сохранения\nлучших решений;
    }
}

package "4. Результат" {
    rectangle "Лучшие стратегии" as result {
        :Оптимизированные параметры;
        :Высокий fitness;
        :Проверенные на backtest;
    }
}

init --> eval
eval --> selection

selection --> crossover
crossover --> mutation
mutation --> eval
eval --> elitism
elitism --> result

note right of init
  **Основа идеи:**
  Теория эволюции Дарвина
  - Размножение
  - Мутация
  - Естественный отбор
  - Выживание сильнейших
end note

note right of selection
  **Аналогия с природой:**
  Сильные особи имеют
  больше шансов
  передать гены потомкам
end note

note right of crossover
  **Комбинирование:**
  Объединение лучших
  качеств от родителей
  для создания потомков
end note

note right of mutation
  **Исследование:**
  Случайные изменения
  помогают найти
  неочевидные решения
end note

@enduml

